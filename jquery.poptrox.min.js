/* jquery.poptrox.js v2.5.0 | (c) n33 | n33.co | MIT licensed */
!function(b){b.fn.poptrox_disableSelection=function(){return b(this).css("user-select","none").css("-khtml-user-select","none").css("-moz-user-select","none").css("-o-user-select","none").css("-webkit-user-select","none")},b.fn.poptrox=function(c){function o(){j=b(window).width(),k=b(window).height()+e.windowHeightPad;var a=Math.abs(q.width()-q.outerWidth()),c=Math.abs(q.height()-q.outerHeight());s.width(),s.height();var g=j-2*e.windowMargin-a,h=k-2*e.windowMargin-c;q.css("min-width",e.popupWidth).css("min-height",e.popupHeight),r.children().css("max-width",g).css("max-height",h)}function p(){return b(e.selector,f).not("[data-poptrox^='ignore']")}if(0==this.length)return b(this);if(this.length>1){for(var d=0;d<this.length;d++)b(this[d]).poptrox(c);return b(this)}var j,k,e=b.extend({preload:!1,baseZIndex:1e3,fadeSpeed:300,overlayColor:"#000000",overlayOpacity:.6,overlayClass:"poptrox-overlay",windowMargin:50,windowHeightPad:0,selector:"a",caption:null,parent:"body",popupSpeed:300,popupWidth:200,popupHeight:100,popupIsFixed:!1,useBodyOverflow:!1,usePopupEasyClose:!0,usePopupForceClose:!1,usePopupLoader:!0,usePopupCloser:!0,usePopupCaption:!1,usePopupNav:!1,usePopupDefaultStyling:!0,popupBackgroundColor:"#FFFFFF",popupTextColor:"#000000",popupLoaderTextSize:"2em",popupCloserBackgroundColor:"#000000",popupCloserTextColor:"#FFFFFF",popupCloserTextSize:"20px",popupPadding:10,popupCaptionHeight:60,popupCaptionTextSize:null,popupBlankCaptionText:"(untitled)",popupCloserText:"&#215;",popupLoaderText:"&bull;&bull;&bull;&bull;",popupClass:"poptrox-popup",popupSelector:null,popupLoaderSelector:".loader",popupCloserSelector:".closer",popupCaptionSelector:".caption",popupNavPreviousSelector:".nav-previous",popupNavNextSelector:".nav-next",onPopupClose:null,onPopupOpen:null},c),f=b(this),g=b("body"),h=b('<div class="'+e.overlayClass+'"></div>'),i=b(window),l=0,m=!1,n=new Array;e.usePopupLoader||(e.popupLoaderSelector=null),e.usePopupCloser||(e.popupCloserSelector=null),e.usePopupCaption||(e.popupCaptionSelector=null),e.usePopupNav||(e.popupNavPreviousSelector=null,e.popupNavNextSelector=null);var q;q=e.popupSelector?b(e.popupSelector):b('<div class="'+e.popupClass+'">'+(e.popupLoaderSelector?'<div class="loader">'+e.popupLoaderText+"</div>":"")+'<div class="pic"></div>'+(e.popupCaptionSelector?'<div class="caption"></div>':"")+(e.popupCloserSelector?'<span class="closer">'+e.popupCloserText+"</span>":"")+(e.popupNavPreviousSelector?'<div class="nav-previous"></div>':"")+(e.popupNavNextSelector?'<div class="nav-next"></div>':"")+"</div>");var r=q.find(".pic"),s=b(),t=q.find(e.popupLoaderSelector),u=q.find(e.popupCaptionSelector),v=q.find(e.popupCloserSelector),w=q.find(e.popupNavNextSelector),x=q.find(e.popupNavPreviousSelector),y=w.add(x);if(e.usePopupDefaultStyling&&(q.css("background",e.popupBackgroundColor).css("color",e.popupTextColor).css("padding",e.popupPadding+"px"),u.length>0&&(q.css("padding-bottom",e.popupCaptionHeight+"px"),u.css("position","absolute").css("left","0").css("bottom","0").css("width","100%").css("text-align","center").css("height",e.popupCaptionHeight+"px").css("line-height",e.popupCaptionHeight+"px"),e.popupCaptionTextSize&&u.css("font-size",popupCaptionTextSize)),v.length>0&&v.html(e.popupCloserText).css("font-size",e.popupCloserTextSize).css("background",e.popupCloserBackgroundColor).css("color",e.popupCloserTextColor).css("display","block").css("width","40px").css("height","40px").css("line-height","40px").css("text-align","center").css("position","absolute").css("text-decoration","none").css("outline","0").css("top","0").css("right","-40px"),t.length>0&&t.html("").css("position","relative").css("font-size",e.popupLoaderTextSize).on("startSpinning",function(){var c=b("<div>"+e.popupLoaderText+"</div>");c.css("height",Math.floor(e.popupHeight/2)+"px").css("overflow","hidden").css("line-height",Math.floor(e.popupHeight/2)+"px").css("text-align","center").css("margin-top",Math.floor((q.height()-c.height()+(u.length>0?u.height():0))/2)).css("color",e.popupTextColor?e.popupTextColor:"").on("xfin",function(){c.fadeTo(300,.5,function(){c.trigger("xfout")})}).on("xfout",function(){c.fadeTo(300,.05,function(){c.trigger("xfin")})}).trigger("xfin"),t.append(c)}).on("stopSpinning",function(){var b=t.find("div");b.remove()}),2==y.length)){y.css("font-size","75px").css("text-align","center").css("color","#fff").css("text-shadow","none").css("height","100%").css("position","absolute").css("top","0").css("opacity","0.35").css("cursor","pointer").css("box-shadow","inset 0px 0px 10px 0px rgba(0,0,0,0)").poptrox_disableSelection();var z,A;e.usePopupEasyClose?(z="100px",A="100px"):(z="75%",A="25%"),w.css("right","0").css("width",z).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; right: 0; margin-top: -50px;">&gt;</div>'),x.css("left","0").css("width",A).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; left: 0; margin-top: -50px;">&lt;</div>')}i.on("resize orientationchange",function(){o()}),u.on("update",function(a,b){b&&0!=b.length||(b=e.popupBlankCaptionText),u.html(b)}),v.css("cursor","pointer").on("click",function(a){return a.preventDefault(),a.stopPropagation(),q.trigger("poptrox_close"),!0}),w.on("click",function(){q.trigger("poptrox_next")}),x.on("click",function(){q.trigger("poptrox_previous")}),h.css("position","fixed").css("left",0).css("top",0).css("z-index",e.baseZIndex).css("width","100%").css("height","100%").css("text-align","center").css("cursor","pointer").appendTo(e.parent).prepend('<div style="display:inline-block;height:100%;vertical-align:middle;"></div>').append('<div style="position:absolute;left:0;top:0;width:100%;height:100%;background:'+e.overlayColor+";opacity:"+e.overlayOpacity+";filter:alpha(opacity="+100*e.overlayOpacity+');"></div>').hide().on("touchmove",function(){return!1}).on("click",function(a){a.preventDefault(),a.stopPropagation(),q.trigger("poptrox_close")}),e.usePopupEasyClose&&r.css("cursor","pointer").on("click",function(a){a.preventDefault(),a.stopPropagation(),q.trigger("poptrox_close")}),q.css("display","inline-block").css("vertical-align","middle").css("position","relative").css("z-index",1).appendTo(h).hide().on("poptrox_next",function(a){var b=p(),c=l+1;return c>=b.length&&(c=0),B(b[c],a)}).on("poptrox_previous",function(a){var b=p(),c=l-1;return 0>c&&(c=b.length-1),B(b[c],a)}).on("poptrox_reset",function(){o(),q.data("width",e.popupWidth).data("height",e.popupHeight),t.hide().trigger("stopSpinning"),u.hide(),v.hide(),y.hide(),r.hide(),s.detach()}).on("poptrox_open",function(a,b){return m?!0:(m=!0,e.useBodyOverflow&&g.css("overflow","hidden"),e.onPopupOpen&&e.onPopupOpen(),h.fadeTo(e.fadeSpeed,1,function(){q.trigger("poptrox_switch",[b,!0])}),void 0)}).on("poptrox_switch",function(a,c,d){var f;return!d&&m?!0:(m=!0,q.css("width",q.data("width")).css("height",q.data("height")),u.hide(),s.attr("src")&&s.attr("src",""),s.detach(),f=c,s=f.object,s.off("load"),r.css("text-indent","-9999px").show().append(s),"ajax"==f.type?b.get(f.src,function(a){s.html(a),s.trigger("load")}):s.attr("src",f.src),"image"!=f.type&&s.css("position","relative").css("outline","0").css("z-index",e.baseZIndex+100).width(f.width).height(f.height),t.trigger("startSpinning").fadeIn(300),q.show(),e.popupIsFixed?(q.width(e.popupWidth).height(e.popupHeight),s.load(function(){s.off("load"),t.hide().trigger("stopSpinning"),u.trigger("update",[f.captionText]).fadeIn(e.fadeSpeed),v.fadeIn(e.fadeSpeed),r.css("text-indent",0).hide().fadeIn(e.fadeSpeed,function(){m=!1}),l=f.index,y.fadeIn(e.fadeSpeed)})):s.load(function(){o(),s.off("load"),t.hide().trigger("stopSpinning");var a=s.width(),b=s.height(),c=function(){u.trigger("update",[f.captionText]).fadeIn(e.fadeSpeed),v.fadeIn(e.fadeSpeed),r.css("text-indent",0).hide().fadeIn(e.fadeSpeed,function(){m=!1}),l=f.index,y.fadeIn(e.fadeSpeed),q.data("width",a).data("height",b).css("width","auto").css("height","auto")};a==q.data("width")&&b==q.data("height")?c():q.animate({width:a,height:b},e.popupSpeed,"swing",c)}),"image"!=f.type&&s.trigger("load"),void 0)}).on("poptrox_close",function(){return m&&!e.usePopupForceClose?!0:(m=!0,q.hide().trigger("poptrox_reset"),e.onPopupClose&&e.onPopupClose(),h.fadeOut(e.fadeSpeed,function(){e.useBodyOverflow&&g.css("overflow","auto"),m=!1}),void 0)}).trigger("poptrox_reset"),i.keydown(function(a){if(q.is(":visible"))switch(a.keyCode){case 37:case 32:if(e.usePopupNav)return q.trigger("poptrox_previous"),!1;break;case 39:if(e.usePopupNav)return q.trigger("poptrox_next"),!1;break;case 27:return q.trigger("poptrox_close"),!1}});var B=function(c,d){c=b(c);var i,j,k,f=c.index(),g=c.find("img"),h=c.data("poptrox");if(c.attr("href")){if(i={index:f,link:c,src:c.attr("href"),captionText:g.attr("title"),width:c.attr("width"),height:c.attr("height"),type:null,object:null},e.caption){if("function"==typeof e.caption)k=e.caption(a);else if("selector"in e.caption){var l=c.find(e.caption.selector);"attribute"in e.caption?k=l.attr(e.caption.attribute):(k=l.html(),e.caption.remove===!0&&l.remove())}}else k=g.attr("title");if(i.captionText=k,h){var m,n=h.split(",");for(m in n)j=n[m].match(/([0-9]+)x([0-9]+)/),j&&3==j.length?(i.width=j[1],i.height=j[2]):i.type=n[m]}if(!i.type)switch(j=i.src.match(/http[s]?:\/\/([a-z0-9\.]+)\/.*/),(!j||j.length<2)&&(j=[!1]),j[1]){case"api.soundcloud.com":i.type="soundcloud";break;case"youtu.be":i.type="youtube",i.width=800,i.height=480;break;case"vimeo.com":i.type="vimeo",i.width=800,i.height=480;break;case"wistia.net":i.type="wistia",i.width=800,i.height=480;break;case"bcove.me":i.type="bcove",i.width=640,i.height=360;break;default:i.type="image"}switch(j=i.src.match(/http([s]?):\/\/[a-z0-9\.]+\/(.*)/),j&&(i.prefix="http"+("s"==j[1]?"s":"")),i.type){case"ignore":break;case"iframe":i.object=b('<iframe src="" frameborder="0"></iframe>'),i.object.on("click",function(a){a.stopPropagation()}).css("cursor","auto");break;case"ajax":i.object=b('<div class="poptrox-ajax"></div>'),i.object.on("click",function(a){a.stopPropagation()}).css("cursor","auto").css("overflow","auto");break;case"soundcloud":i.object=b('<iframe scrolling="no" frameborder="no" src=""></iframe>'),i.src=i.prefix+"://w.soundcloud.com/player/?url="+escape(i.src),i.width="600",i.height="166";break;case"youtube":i.object=b('<iframe src="" frameborder="0" allowfullscreen="1"></iframe>'),i.src=i.prefix+"://www.youtube.com/embed/"+j[2];break;case"vimeo":i.object=b('<iframe src="" frameborder="0" allowFullScreen="1"></iframe>'),i.src=i.prefix+"://player.vimeo.com/video/"+j[2];break;case"wistia":i.object=b('<iframe src="" frameborder="0" allowFullScreen="1"></iframe>'),i.src=i.prefix+"://fast.wistia.net/"+j[2];break;case"bcove":i.object=b('<iframe src="" frameborder="0" allowFullScreen="1" width="100%"></iframe>'),i.src=i.prefix+"://bcove.me/"+j[2];break;default:i.object=b('<img src="" alt="" style="vertical-align:bottom" />')}"ignore"!=i.type&&(c.css("outline",0),d.preventDefault(),d.stopPropagation(),q.trigger("poptrox_open",[i]))}},C=function(){e.preload&&b(e.selector,f).not("[data-poptrox]").each(function(){var a=b(this).attr("href");tmp=document.createElement("img"),tmp.src=a,n.push(tmp)})};return f.delegate(e.selector,"click",function(a){B(this,a)}),C(),b(this)}}(jQuery);